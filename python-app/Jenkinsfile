pipeline {
    agent any

    environment {
        DEPLOY_DIR = "${WORKSPACE}/deploy/python-app"
    }

    stage('Install') {
    steps {
        dir('python-app') {
            sh '''
                python3 -m venv venv
                . venv/bin/activate
                pip install -r requirements.txt
            '''
        }
    }
}

stage('Test') {
    steps {
        dir('python-app') {
            sh '''
                . venv/bin/activate
                pytest -q --disable-warnings
            '''
        }
    }
}
